<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Extend Payment Provider Form -->
    <record id="payment_provider_form_midtrans" model="ir.ui.view">
        <field name="name">payment.provider.form.midtrans</field>
        <field name="model">payment.provider</field>
        <field name="inherit_id" ref="payment.payment_provider_form"/>
        <field name="arch" type="xml">
            <!-- Add Midtrans Credentials Tab -->
            <xpath expr="//page[@name='configuration']" position="after">
                <page string="Midtrans Credentials" 
                      invisible="code != 'midtrans'"
                      name="midtrans_credentials">
                    <group>
                        <group string="API Credentials">
                            <field name="midtrans_merchant_id" 
                                   placeholder="G123456789"
                                   required="code == 'midtrans' and state != 'disabled'"/>
                            <field name="midtrans_client_key" 
                                   placeholder="SB-Mid-client-xxxxxxxxxxxxxxxx"
                                   required="code == 'midtrans' and state != 'disabled'"/>
                            <field name="midtrans_server_key" 
                                   password="True"
                                   placeholder="SB-Mid-server-xxxxxxxxxxxxxxxx"
                                   required="code == 'midtrans' and state != 'disabled'"/>
                        </group>
                        <group string="Information">
                            <div class="alert alert-info" role="alert">
                                <h4>Setup Instructions:</h4>
                                <ol>
                                    <li>Login ke <a href="https://dashboard.midtrans.com" target="_blank">Midtrans Dashboard</a></li>
                                    <li>Pilih Environment: <strong>Sandbox</strong> (testing) atau <strong>Production</strong></li>
                                    <li>Go to <strong>Settings → Access Keys</strong></li>
                                    <li>Copy <strong>Merchant ID</strong>, <strong>Client Key</strong>, dan <strong>Server Key</strong></li>
                                    <li>Paste di form ini</li>
                                    <li>Untuk testing gunakan credentials Sandbox (awalan SB-)</li>
                                </ol>
                                <h4>Webhook Configuration:</h4>
                                <p>Daftarkan URL ini di Midtrans Dashboard → Settings → Notification:</p>
                                <code style="background: #f5f5f5; padding: 5px; display: block; margin: 5px 0;">
                                    https://yourdomain.com/payment/midtrans/notification
                                </code>
                            </div>
                        </group>
                    </group>
                    <group>
                        <button name="action_publish_midtrans" 
                                string="Publish Midtrans" 
                                type="object" 
                                class="btn-primary"
                                invisible="is_published"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>